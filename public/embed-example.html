<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Embeddable Tracker Example</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .tracking-demo {
            background: #f5f5f5;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        .tracking-demo h3 {
            margin-top: 0;
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #0056b3;
        }
        .customer-card {
            border: 1px solid #ddd;
            padding: 15px;
            margin: 10px 0;
            border-radius: 4px;
            background: white;
        }
        .customer-card h4 {
            margin-top: 0;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
    </style>
</head>
<body>
    <h1>Embeddable Customer Tracking System Demo</h1>
    
    <div class="tracking-demo">
        <h3>Configuration</h3>
        <button onclick="configureTracker()">Configure Tracker</button>
        <button onclick="toggleDebug()">Toggle Debug Mode</button>
        <div id="config-status" class="status info">Tracker not configured</div>
    </div>

    <div class="tracking-demo">
        <h3>Manual Event Tracking</h3>
        <button onclick="trackLogin()">Track Login Event</button>
        <button onclick="trackFeatureUsage()">Track Feature Usage</button>
        <button onclick="trackCustomerInteraction()">Track Customer Interaction</button>
        <button onclick="trackCustomEvent()">Track Custom Event</button>
    </div>

    <div class="tracking-demo">
        <h3>Automatic Tracking (Data Attributes)</h3>
        <p>Click on the buttons below to see automatic tracking:</p>
        
        <button data-track="button_click" data-track-data='{"button_type": "primary", "section": "demo"}'>
            Tracked Button 1
        </button>
        
        <button data-track="feature_access" data-track-data='{"feature": "demo_feature", "user_type": "demo"}'>
            Tracked Button 2
        </button>
        
        <button data-track="customer_action" data-track-data='{"action": "view_profile", "customer_id": "demo_customer_123"}'>
            View Customer Profile
        </button>
    </div>

    <div class="tracking-demo">
        <h3>Customer Cards (Interactive)</h3>
        
        <div class="customer-card" data-track="customer_card_click" data-track-data='{"customer_id": "cust_001", "customer_name": "Acme Corp", "arr": "$50,000"}'>
            <h4>Acme Corp</h4>
            <p>ARR: $50,000 | Health Score: 85</p>
            <button onclick="trackCustomerDetail('cust_001', 'Acme Corp')">View Details</button>
        </div>
        
        <div class="customer-card" data-track="customer_card_click" data-track-data='{"customer_id": "cust_002", "customer_name": "TechStart Inc", "arr": "$25,000"}'>
            <h4>TechStart Inc</h4>
            <p>ARR: $25,000 | Health Score: 72</p>
            <button onclick="trackCustomerDetail('cust_002', 'TechStart Inc')">View Details</button>
        </div>
        
        <div class="customer-card" data-track="customer_card_click" data-track-data='{"customer_id": "cust_003", "customer_name": "Global Solutions", "arr": "$100,000"}'>
            <h4>Global Solutions</h4>
            <p>ARR: $100,000 | Health Score: 95</p>
            <button onclick="trackCustomerDetail('cust_003', 'Global Solutions')">View Details</button>
        </div>
    </div>

    <div class="tracking-demo">
        <h3>Session Information</h3>
        <div id="session-info">
            <p><strong>Session ID:</strong> <span id="session-id">Loading...</span></p>
            <p><strong>Page URL:</strong> <span id="page-url">Loading...</span></p>
            <p><strong>User Agent:</strong> <span id="user-agent">Loading...</span></p>
        </div>
    </div>

    <!-- Include the embeddable tracker script -->
    <script src="embed-tracker.js"></script>
    
    <script>
        // Wait for tracker to load
        function waitForTracker() {
            if (window.EmbedTracker) {
                initializeDemo();
            } else {
                setTimeout(waitForTracker, 100);
            }
        }

        function initializeDemo() {
            // Update session info
            document.getElementById('session-id').textContent = window.EmbedTracker.sessionId;
            document.getElementById('page-url').textContent = window.location.href;
            document.getElementById('user-agent').textContent = navigator.userAgent.substring(0, 50) + '...';
            
            // Enable debug mode for demo
            window.EmbedTracker.setDebug(true);
            
            updateConfigStatus('Tracker loaded and ready');
        }

        function updateConfigStatus(message, type = 'success') {
            const statusEl = document.getElementById('config-status');
            statusEl.textContent = message;
            statusEl.className = `status ${type}`;
        }

        function configureTracker() {
            window.EmbedTracker.configure({
                endpoint: 'http://localhost:5001/api/events',
                authToken: '666158fe71bfe10b58cb23eea',
                debug: true
            });
            updateConfigStatus('Tracker configured successfully');
        }

        function toggleDebug() {
            const currentDebug = window.EmbedTracker.CONFIG?.debug || false;
            window.EmbedTracker.setDebug(!currentDebug);
            updateConfigStatus(`Debug mode: ${!currentDebug ? 'enabled' : 'disabled'}`);
        }

        function trackLogin() {
            window.EmbedTracker.trackLoginEvent({
                user_id: 'demo_user_123',
                email: 'demo@example.com',
                organization: 'demo_org',
                login_method: 'email_password',
                additional_data: {
                    login_source: 'demo_page',
                    demo_mode: true
                }
            });
            updateConfigStatus('Login event tracked');
        }

        function trackFeatureUsage() {
            window.EmbedTracker.trackFeatureUsage('demo_feature', {
                user_id: 'demo_user_123',
                email: 'demo@example.com',
                organization: 'demo_org',
                additional_data: {
                    feature_version: '1.0.0',
                    demo_mode: true
                }
            });
            updateConfigStatus('Feature usage tracked');
        }

        function trackCustomerInteraction() {
            window.EmbedTracker.trackCustomerEvent({
                customer_id: 'demo_customer_123',
                customer_name: 'Demo Customer',
                interaction_type: 'profile_view',
                additional_data: {
                    interaction_duration: '30 seconds',
                    demo_mode: true
                }
            });
            updateConfigStatus('Customer interaction tracked');
        }

        function trackCustomEvent() {
            window.EmbedTracker.trackEvent('custom_demo_event', {
                event_category: 'demo',
                event_action: 'button_click',
                event_label: 'manual_tracking',
                additional_data: {
                    demo_mode: true,
                    timestamp: new Date().toISOString()
                }
            });
            updateConfigStatus('Custom event tracked');
        }

        function trackCustomerDetail(customerId, customerName) {
            window.EmbedTracker.trackCustomerEvent({
                customer_id: customerId,
                customer_name: customerName,
                interaction_type: 'detail_view',
                additional_data: {
                    view_source: 'customer_card',
                    demo_mode: true
                }
            });
            updateConfigStatus(`Customer detail view tracked for ${customerName}`);
        }

        // Initialize when page loads
        waitForTracker();
    </script>
</body>
</html> 